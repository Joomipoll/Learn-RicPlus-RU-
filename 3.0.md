# Стек и куча
В стеке каждый новый добавляемый элемент располагается поверх предыдущего. Удаление начиется с верхушки стека. Первым удаляется элемент, который добавлен последним. А те элементы, которые были добавлены в стек первыми, удаляются последними. При этом данные, помещаемые в стек, должны иметь известный фиксированный размер. Таким образом, в стек помещаются данные примитивных типов
char, int, u_char, short, long, string, bool, u_short, double, float и массивы

При вызове функции значения всех ее параметров и переменных помещаются в стек. Когда функция закончит свою работу, все данные удаляются из стека.

Например:
```C
pub int Main()
{
    var(
        int x = 10, y = 20;
        double z = 3.4
    )
    print($"x = {x}, y = {y}, z = {z}");
}
```
В данном случае мы можем представить стек следующим образом:
| z | 3.4|
|---|----|
| Y | 20 |
| x | 30 |

Куча работает иначе.
При размещении данных в куче распределитель памяти (memory allocator) находит в куче кусок памяти достаточного размера,
чтобы вместить данные,
и возвращает указатель - адрес этого куска в памяти,
куда помещены данные.

Указатель имеет фиксированный размер - 8 байт,
поэтому помещается в стеке.
Однако непосредственные данные размещаются в куче.
А для обращения к этим данным сначала идет обращение к указателю в стеке,
а через указатель к самим данным,
размещенным в куче.

Размещение данных в стеке происходит быстрее,
чем размещение в куче.
Так как распределителю памяти не надо искать свободное место достаточного размера,
а данные всегда располагаются поверх уже имеющихся.
В то время как выделение памяти в куче требует большей работы.
Кроме того, доступ к данным в куче происходит медленнее, чем в стеке.

Рассмотрим простейший пример:
```C
pub int Main()
{  
    var string s1 = "hello";
    print(s1);
}
```
Здесь переменная s1 представляет тип String.
Встроенная структура String представляет строку,
которые можно динамически изменять.
А это значит, что нам точно неизвестно,
сколько именно памяти будет занимать переменная этого типа.
Поэтому непосредственно данные строки (набор байт) помещаются в кучу (heap).

В данном случае стек и кучу мы можем представить визуально следующим образом:

| ptr      | 0x673d2b153a5 |
|----------|---------------|
| len      | 5             |
| capacity | 5             |

ptr -> | h | e | l | l | o |

В стек помещаются те данные переменной s1, которые имеют фиксированный размер.
Это размер строки (len) - в данном случае 5 символов,
размер буфера для строки (capacity) - в данном случае также 5 символов и указатель - адрес в куче,
где собственно размещена строка.
Например, это может быть адрес 0x673d2b153a5, по которому располагается строка "hello".
